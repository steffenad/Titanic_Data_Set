# Exploring Titanic Data Set


### Loading Libraries

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
%matplotlib inline


### Loading Data Set (Titanic Data Set from Kaggle: https://www.kaggle.com/c/titanic)

train = pd.read_excel('Titanic_Train.xlsx')
test = pd.read_excel('Titanic_Test.xlsx')


### Data Preparation

# convert data type to 'category' for PassengerId, Pclass, Ticket, Name and Embarked
train[['Survived','PassengerId','Pclass','Ticket','Name','Embarked']] = train[['Survived','PassengerId','Pclass','Ticket','Name','Embarked']].astype('category')


# delete irrelevant features: PassengerId and Ticket redundant, Cabin too many missing values
train.drop(['PassengerId','Cabin','Ticket'],axis=1, inplace=True)


# Missing values


# Any missing values?
train.isnull().values.any()

# Total missing values for each feature
train.isnull().sum()

#plotting missing values
sns.heatmap(train.isnull(),yticklabels=False,cbar=False)

#observations with missing values for variable "Fare"
train[train['Fare'].isnull()]

# deleting one observation with missing value for "Fare"
train.drop([152],inplace=True)

# imputing mean for missing values in "Age"
train['Age'] = train['Age'].fillna(value=train['Age'].mean())

#plotting missing values now
sns.heatmap(train.isnull(),yticklabels=False,cbar=False)


#change names for feature "Survived"
def change(parameter):
    if parameter == 1:
        return 'Survived'
    else:
        return 'Died'
train['Survived']= list(map(change,train['Survived']))

#include 'children' into gender column
def person (age, gender):
    if age < 18:
        return 'child'
    else:
        return gender
        
train['Person'] = list(map(person,train['Age'],train['Sex']))
train = train.drop('Sex',axis=1)


### Data Exploration and Visualisation


#Survivals

#plotting Survivals
sns.countplot(x="Survived",data=train)

#How many male, female passengers and childen were on board?
sns.countplot(x="Person",data=train)

#How many males, females and children were in different ship classes?
sns.countplot(x="Person",hue="Pclass",data=train)

#plotting Survivals and Class
sns.countplot(x='Survived',data=train, hue='Pclass')

#plotting Survivals separated in 2 two grids for different passenger classes
sns.catplot(x='Pclass',data=train,hue='Person',col='Survived',kind='count')


#age of passengers and its distribution per class
sns.boxplot(x='Pclass',y='Age',data=train)


#distribution for 'Age' and 'Fare'
train['Fare'].hist(grid=False)
train['Age'].hist(grid=False)

Data Preparation

#change data type


Modelling Process

#Separating Data Set into training and testing data
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(train.drop('Survived',axis=1), 
                                                    train['Survived'], test_size=0.30, 
                                                    random_state=101)
